var util=function(){return{extend:function(t,e){for(var i in e)void 0===t[i]&&(t[i]=e[i])},addClass:function(t,e){var i=t.className||"";(" "+i+" ").indexOf(" "+e+" ")===-1&&(t.className=i?i+" "+e:e)},delClass:function(t,e){var i=t.className||"";t.className=(" "+i+" ").replace(" "+e+" "," ").trim()},emitter:{on:function(t,e){var i=this._handles||(this._handles={}),s=i[t]||(i[t]=[]);return s.push(e),this},off:function(t,e){if(t&&this._handles||(this._handles={}),this._handles){var i,s=this._handles;if(i=s[t]){if(!e)return s[t]=[],this;for(var n=0,a=i.length;n<a;n++)if(e===i[n])return i.splice(n,1),this}return this}},emit:function(t){var e,i=[].slice.call(arguments,1),s=this._handles;if(!s||!(e=s[t]))return this;for(var n=0,a=e.length;n<a;n++)e[n].apply(this,i);return this}}}}();!function(t){function e(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]}function i(e){t.extend(this,e),this.container=this.container||document.body,this.container.style.overflow="hidden",this.slider=this._layout.cloneNode(!0),this.slides=[].slice.call(this.slider.querySelectorAll(".slide")),this.offsetWidth=this.container.offsetWidth,this.breakPoint=this.offsetWidth/4,this.pageNum=this.images.length,this.slideIndex=1,this.pageIndex=this.pageIndex||0,this.offsetAll=this.pageIndex,this.container.appendChild(this.slider),this.drag&&this._initDrag()}var s='<div class="m-slider" ><div class="slide"></div><div class="slide"></div><div class="slide"></div></div>';t.extend(i.prototype,t.emitter),t.extend(i.prototype,{_layout:e(s),nav:function(t){this.pageIndex=t,this.slideIndex="number"==typeof this.slideIndex?this.slideIndex:(t+1)%3,this.offsetAll=t,this.slider.style.transitionDuration="0s",this._calcSlide()},next:function(){this._step(1)},prev:function(){this._step(-1)},_step:function(t){this.offsetAll+=t,this.pageIndex+=t,this.slideIndex+=t,this.slider.style.transitionDuration=".5s",this._calcSlide()},_calcSlide:function(){var e=this.slideIndex=this._normIndex(this.slideIndex,3),i=(this.pageIndex=this._normIndex(this.pageIndex,this.pageNum),this.offsetAll),s=(this.pageNum,this._normIndex(e-1,3)),n=this._normIndex(e+1,3),a=this.slides;a[e].style.left=100*i+"%",a[s].style.left=100*(i-1)+"%",a[n].style.left=100*(i+1)+"%",this.slider.style.transform="translateX("+100*-i+"%) translateZ(0)",a.forEach(function(e){t.delClass(e,"z-active")}),t.addClass(a[e],"z-active"),this._onNav(this.pageIndex,this.slideIndex)},_normIndex:function(t,e){return(e+t)%e},_onNav:function(t,e){for(var i=this.slides,s=-1;s<=1;s++){var n=(e+s+3)%3,a=i[n].querySelector("img");a||(a=document.createElement("img"),i[n].appendChild(a)),a.src="./images/pic0"+(this._normIndex(t+s,this.pageNum)+1)+".jpg"}this.emit("nav",{pageIndex:t,slideIndex:e})},_initDrag:function(){this._dragInfo={},this.slider.addEventListener("mousedown",this._dragstart.bind(this)),this.slider.addEventListener("mousemove",this._dragmove.bind(this)),this.slider.addEventListener("mouseup",this._dragend.bind(this)),this.slider.addEventListener("mouseleave",this._dragend.bind(this))},_dragstart:function(t){var e=this._dragInfo;e.start={x:t.pageX,y:t.pageY}},_dragmove:function(t){var e=this._dragInfo;if(e.start){t.preventDefault(),this.slider.style.transitionDuration="0s";var i=e.start;window.getSelection?window.getSelection().removeAllRanges():window.document.selection&&window.document.selection.empty(),this.slider.style.transform="translateX("+-(this.offsetWidth*this.offsetAll-t.pageX+i.x)+"px) translateZ(0)"}},_dragend:function(t){var e=this._dragInfo;if(e.start){t.preventDefault();var i=e.start;this._dragInfo={};var s=t.pageX,n=s-i.x;Math.abs(n)>this.breakPoint?this._step(n>0?-1:1):this._step(0)}}}),window.Slider=i}(util);